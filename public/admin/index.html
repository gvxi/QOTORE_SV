<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Qotor</title>
    <style>
        
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-container">
            <!-- Left: Logo -->
            <div class="logo-section">
                <img src="/api/image/logo.png" alt="Qotor" class="logo-image" onerror="this.style.display='none';">
                <span class="logo-text">Qotor</span>
                <span class="admin-badge" data-key="admin_panel">Admin Panel</span>
            </div>

            <!-- Right: Controls -->
            <div class="header-controls">
                <!-- Notifications -->
                <div class="notification-controls">
                    <button class="control-btn notification-toggle" id="notificationToggle" title="Toggle Notifications">
                        <img src="/api/image/notification-icon.png" alt="Notifications" onerror="this.textContent='🔔';">
                        <span class="notification-status" id="notificationStatus">OFF</span>
                    </button>
                    <div class="notification-badge" id="notificationBadge">0</div>
                </div>

                <!-- Language Switcher -->
                <div class="language-selector">
                    <button class="control-btn language-btn" id="languageBtn" title="Language">
                        <img src="/api/image/language-icon.png" alt="Language" onerror="this.textContent='EN';">
                    </button>
                    <div class="language-dropdown" id="languageDropdown">
                        <button class="language-option" data-lang="en">
                            <img src="/api/image/en-flag.png" alt="English" onerror="this.textContent='EN';">
                            <span>English</span>
                        </button>
                        <button class="language-option" data-lang="ar">
                            <img src="/api/image/ar-flag.png" alt="العربية" onerror="this.textContent='AR';">
                            <span>العربية</span>
                        </button>
                    </div>
                </div>

                <!-- View Store -->
                <a href="/index.html" class="control-btn store-btn" title="View Store">
                    <img src="/api/image/store-icon.png" alt="Store" onerror="this.textContent='🏪';">
                </a>

                <!-- Logout -->
                <button class="control-btn logout-btn" id="logoutBtn" title="Logout">
                    <img src="/api/image/logout-icon.png" alt="Logout" onerror="this.textContent='🚪';">
                </button>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="admin-nav">
        <div class="nav-container">
            <button class="nav-tab active" data-tab="dashboard" data-key="nav_dashboard">Dashboard</button>
            <button class="nav-tab" data-tab="orders" data-key="nav_orders">Orders</button>
            <button class="nav-tab" data-tab="fragrances" data-key="nav_fragrances">Fragrances</button>
            <button class="nav-tab" data-tab="analytics" data-key="nav_analytics">Analytics</button>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Dashboard Tab -->
        <div id="dashboardTab" class="tab-content active">
            <!-- Status Bar -->
            <div class="status-bar">
                <div class="status-info">
                    <img src="/api/image/admin-active-icon.png" alt="Active" class="status-icon" onerror="this.textContent='✨';">
                    <span data-key="admin_active">Admin Dashboard Active - Welcome back!</span>
                </div>
                <button class="add-fragrance-btn" id="addFragranceBtn">
                    <img src="/api/image/plus-icon.png" alt="Add" class="btn-icon" onerror="this.textContent='+';">
                    <span data-key="add_fragrance">Add New Fragrance</span>
                </button>
            </div>

            <!-- Statistics Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <img src="/api/image/orders-icon.png" alt="Orders" class="stat-icon" onerror="this.textContent='📦';">
                    </div>
                    <div class="stat-number" id="totalOrders">-</div>
                    <div class="stat-label" data-key="total_orders">Total Orders</div>
                    <div class="stat-change" id="ordersChange" data-key="loading">Loading...</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <img src="/api/image/pending-icon.png" alt="Pending" class="stat-icon" onerror="this.textContent='⏳';">
                    </div>
                    <div class="stat-number" id="pendingOrders">-</div>
                    <div class="stat-label" data-key="pending_orders">Pending Orders</div>
                    <div class="stat-change" id="pendingChange" data-key="loading">Loading...</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <img src="/api/image/perfume-icon.png" alt="Fragrances" class="stat-icon" onerror="this.textContent='💎';">
                    </div>
                    <div class="stat-number" id="totalFragrances">-</div>
                    <div class="stat-label" data-key="total_fragrances">Total Fragrances</div>
                    <div class="stat-change" id="fragranceChange" data-key="loading">Loading...</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <img src="/api/image/revenue-icon.png" alt="Revenue" class="stat-icon" onerror="this.textContent='💰';">
                    </div>
                    <div class="stat-number" id="totalRevenue">-</div>
                    <div class="stat-label" data-key="total_revenue">Total Revenue</div>
                    <div class="stat-change" id="revenueChange" data-key="loading">Loading...</div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <h3 data-key="quick_actions">Quick Actions</h3>
                <div class="action-cards">
                    <button class="action-card" onclick="switchToTab('orders')">
                        <img src="/api/image/orders-icon.png" alt="Orders" onerror="this.textContent='📦';">
                        <span data-key="manage_orders">Manage Orders</span>
                    </button>
                    <button class="action-card" onclick="switchToTab('fragrances')">
                        <img src="/api/image/perfume-icon.png" alt="Fragrances" onerror="this.textContent='💎';">
                        <span data-key="manage_fragrances">Manage Fragrances</span>
                    </button>
                    <button class="action-card" onclick="openAddFragrancePanel()">
                        <img src="/api/image/plus-icon.png" alt="Add" onerror="this.textContent='+';">
                        <span data-key="add_new_fragrance">Add New Fragrance</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Orders Tab -->
        <div id="ordersTab" class="tab-content">
            <div class="section-header">
                <h2 class="section-title" data-key="orders_management">Orders Management</h2>
                <div class="section-controls">
                    <div class="search-container">
                        <img src="/api/image/search-icon.png" alt="Search" class="search-icon" onerror="this.textContent='🔍';">
                        <input type="text" id="ordersSearch" class="search-input" data-key-placeholder="search_orders">
                    </div>
                    <select id="ordersFilter" class="filter-select">
                        <option value="all" data-key="all_orders">All Orders</option>
                        <option value="pending" data-key="pending_orders">Pending</option>
                        <option value="completed" data-key="completed_orders">Completed</option>
                        <option value="canceled" data-key="canceled_orders">Canceled</option>
                    </select>
                    <button class="refresh-btn" onclick="refreshOrders()" title="Refresh Orders">
                        <img src="/api/image/refresh-icon.png" alt="Refresh" onerror="this.textContent='🔄';">
                    </button>
                </div>
            </div>

            <!-- Orders Loading -->
            <div id="ordersLoading" class="loading-section">
                <div class="loading-spinner"></div>
                <p class="loading-text" data-key="loading_orders">Loading orders...</p>
            </div>

            <!-- Orders Table -->
            <div id="ordersTable" class="table-container" style="display: none;">
                <table class="orders-table">
                    <thead>
                        <tr>
                            <th data-key="order_id">Order ID</th>
                            <th data-key="customer">Customer</th>
                            <th data-key="items">Items</th>
                            <th data-key="total">Total</th>
                            <th data-key="status">Status</th>
                            <th data-key="date">Date</th>
                            <th data-key="actions">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="ordersTableBody">
                        <!-- Orders will be populated here -->
                    </tbody>
                </table>
            </div>

            <!-- Empty Orders -->
            <div id="emptyOrders" class="empty-state" style="display: none;">
                <img src="/api/image/empty-orders-icon.png" alt="No Orders" class="empty-icon" onerror="this.textContent='📦';">
                <h3 data-key="no_orders">No Orders Found</h3>
                <p data-key="orders_will_appear">Customer orders will appear here once they start placing orders.</p>
            </div>
        </div>

        <!-- Fragrances Tab -->
        <div id="fragrancesTab" class="tab-content">
            <div class="section-header">
                <h2 class="section-title" data-key="fragrances_management">Fragrances Management</h2>
                <div class="section-controls">
                    <div class="search-container">
                        <img src="/api/image/search-icon.png" alt="Search" class="search-icon" onerror="this.textContent='🔍';">
                        <input type="text" id="fragrancesSearch" class="search-input" data-key-placeholder="search_fragrances">
                    </div>
                    <select id="fragrancesFilter" class="filter-select">
                        <option value="all" data-key="all_status">All Status</option>
                        <option value="visible" data-key="visible_only">Visible Only</option>
                        <option value="hidden" data-key="hidden_only">Hidden Only</option>
                    </select>
                    <button class="add-fragrance-btn" onclick="openAddFragrancePanel()">
                        <img src="/api/image/plus-icon.png" alt="Add" onerror="this.textContent='+';">
                        <span data-key="add_fragrance">Add Fragrance</span>
                    </button>
                </div>
            </div>

            <!-- Fragrances Loading -->
            <div id="fragrancesLoading" class="loading-section">
                <div class="loading-spinner"></div>
                <p class="loading-text" data-key="loading_fragrances">Loading fragrances...</p>
            </div>

            <!-- Fragrances Table -->
            <div id="fragrancesTable" class="table-container" style="display: none;">
                <table class="fragrances-table">
                    <thead>
                        <tr>
                            <th data-key="image">Image</th>
                            <th data-key="fragrance_info">Fragrance Info</th>
                            <th data-key="variants">Variants</th>
                            <th data-key="status">Status</th>
                            <th data-key="created">Created</th>
                            <th data-key="actions">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="fragrancesTableBody">
                        <!-- Fragrances will be populated here -->
                    </tbody>
                </table>
            </div>

            <!-- Empty Fragrances -->
            <div id="emptyFragrances" class="empty-state" style="display: none;">
                <img src="/api/image/empty-fragrances-icon.png" alt="No Fragrances" class="empty-icon" onerror="this.textContent='💎';">
                <h3 data-key="no_fragrances">No Fragrances Found</h3>
                <p data-key="add_first_fragrance">Start building your collection by adding your first fragrance.</p>
                <button class="add-fragrance-btn" onclick="openAddFragrancePanel()">
                    <img src="/api/image/plus-icon.png" alt="Add" onerror="this.textContent='+';">
                    <span data-key="add_first">Add First Fragrance</span>
                </button>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="analyticsTab" class="tab-content">
            <div class="section-header">
                <h2 class="section-title" data-key="analytics_dashboard">Analytics Dashboard</h2>
                <div class="section-controls">
                    <select id="analyticsTimeRange" class="filter-select">
                        <option value="week" data-key="last_week">Last Week</option>
                        <option value="month" data-key="last_month">Last Month</option>
                        <option value="quarter" data-key="last_quarter">Last Quarter</option>
                        <option value="year" data-key="last_year">Last Year</option>
                    </select>
                </div>
            </div>

            <!-- Analytics Content -->
            <div class="analytics-content">
                <div class="analytics-grid">
                    <div class="analytics-card">
                        <h4 data-key="sales_overview">Sales Overview</h4>
                        <div class="chart-placeholder">
                            <img src="/api/image/chart-icon.png" alt="Chart" onerror="this.textContent='📊';">
                            <p data-key="chart_coming_soon">Chart coming soon</p>
                        </div>
                    </div>
                    <div class="analytics-card">
                        <h4 data-key="top_fragrances">Top Fragrances</h4>
                        <div class="chart-placeholder">
                            <img src="/api/image/chart-icon.png" alt="Chart" onerror="this.textContent='📈';">
                            <p data-key="chart_coming_soon">Chart coming soon</p>
                        </div>
                    </div>
                    <div class="analytics-card">
                        <h4 data-key="customer_trends">Customer Trends</h4>
                        <div class="chart-placeholder">
                            <img src="/api/image/chart-icon.png" alt="Chart" onerror="this.textContent='📉';">
                            <p data-key="chart_coming_soon">Chart coming soon</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Order Details Modal -->
    <div class="modal-overlay" id="orderModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" data-key="order_details">Order Details</h2>
                <button class="close-btn" onclick="closeOrderModal()">
                    <img src="/api/image/close-icon.png" alt="Close" onerror="this.textContent='✕';">
                </button>
            </div>
            <div class="modal-body">
                <!-- Order Information -->
                <div class="order-info-section">
                    <h3 data-key="order_information">Order Information</h3>
                    <div class="order-info-grid">
                        <div class="info-item">
                            <label data-key="order_id">Order ID:</label>
                            <span id="modalOrderId">-</span>
                        </div>
                        <div class="info-item">
                            <label data-key="order_date">Order Date:</label>
                            <span id="modalOrderDate">-</span>
                        </div>
                        <div class="info-item">
                            <label data-key="order_status">Status:</label>
                            <span id="modalOrderStatus" class="status-badge">-</span>
                        </div>
                        <div class="info-item">
                            <label data-key="total_amount">Total Amount:</label>
                            <span id="modalOrderTotal">-</span>
                        </div>
                    </div>
                </div>

                <!-- Customer Information -->
                <div class="customer-info-section">
                    <h3 data-key="customer_information">Customer Information</h3>
                    <div class="customer-info-grid">
                        <div class="info-item">
                            <label data-key="customer_name">Name:</label>
                            <span id="modalCustomerName">-</span>
                        </div>
                        <div class="info-item">
                            <label data-key="customer_email">Email:</label>
                            <span id="modalCustomerEmail">-</span>
                        </div>
                        <div class="info-item">
                            <label data-key="customer_phone">Phone:</label>
                            <span id="modalCustomerPhone">-</span>
                        </div>
                        <div class="info-item delivery-address">
                            <label data-key="delivery_address">Delivery Address:</label>
                            <span id="modalDeliveryAddress">-</span>
                        </div>
                        <div class="info-item" id="preferredTimeItem" style="display: none;">
                            <label data-key="preferred_time">Preferred Time:</label>
                            <span id="modalPreferredTime">-</span>
                        </div>
                        <div class="info-item" id="specialInstructionsItem" style="display: none;">
                            <label data-key="special_instructions">Special Instructions:</label>
                            <span id="modalSpecialInstructions">-</span>
                        </div>
                    </div>
                </div>

                <!-- Order Items -->
                <div class="order-items-section">
                    <h3 data-key="order_items">Order Items</h3>
                    <div class="order-items-list" id="modalOrderItems">
                        <!-- Items will be populated here -->
                    </div>
                    <div class="order-summary">
                        <div class="summary-row">
                            <span data-key="subtotal">Subtotal:</span>
                            <span id="modalSubtotal">-</span>
                        </div>
                        <div class="summary-row">
                            <span data-key="delivery_fee">Delivery Fee:</span>
                            <span data-key="free">Free</span>
                        </div>
                        <div class="summary-row total">
                            <span data-key="total">Total:</span>
                            <span id="modalTotal">-</span>
                        </div>
                    </div>
                </div>

                <!-- Order Actions -->
                <div class="order-actions">
                    <button class="btn btn-success" onclick="updateOrderStatus('completed')" id="completeOrderBtn" data-key="mark_completed">Mark as Completed</button>
                    <button class="btn btn-warning" onclick="updateOrderStatus('canceled')" id="cancelOrderBtn" data-key="mark_canceled">Mark as Canceled</button>
                    <button class="btn btn-secondary" onclick="contactCustomer()" data-key="contact_customer">Contact Customer</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Fragrance Side Panel -->
    <div class="side-panel" id="fragrancePanel">
        <div class="panel-overlay" id="panelOverlay"></div>
        <div class="panel-content">
            <div class="panel-header">
                <h2 id="panelTitle" data-key="add_new_fragrance">
                    <img src="/api/image/plus-icon.png" alt="Add" class="panel-icon" onerror="this.textContent='+';">
                    Add New Fragrance
                </h2>
                <button class="close-btn" id="closePanelBtn">
                    <img src="/api/image/close-icon.png" alt="Close" onerror="this.textContent='✕';">
                </button>
            </div>
            
            <div class="panel-body">
                <div id="success-message" class="message success"></div>
                <div id="error-message" class="message error"></div>

                <form id="fragranceForm" class="fragrance-form">
                    <input type="hidden" id="fragranceId" name="id">
                    
                    <div class="form-group">
                        <label for="name" class="form-label">
                            <span data-key="fragrance_name">Fragrance Name</span>
                            <span class="required">*</span>
                        </label>
                        <input type="text" id="name" name="name" class="form-input" required 
                               data-key-placeholder="name_placeholder">
                    </div>

                    <div class="form-group">
                        <label for="brand" class="form-label" data-key="brand">Brand</label>
                        <input type="text" id="brand" name="brand" class="form-input" 
                               data-key-placeholder="brand_placeholder">
                    </div>

                    <div class="form-group">
                        <label for="slug" class="form-label">
                            <span data-key="url_slug">URL Slug</span>
                            <span class="required">*</span>
                        </label>
                        <input type="text" id="slug" name="slug" class="form-input" required 
                               data-key-placeholder="slug_placeholder">
                    </div>

                    <div class="form-group">
                        <label for="description" class="form-label">
                            <span data-key="description">Description</span>
                            <span class="required">*</span>
                        </label>
                        <textarea id="description" name="description" class="form-input" required 
                                  data-key-placeholder="description_placeholder"></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label" data-key="product_image">Product Image</label>
                        <input type="file" id="image" name="image" accept=".png,image/png" class="file-input">
                        <div class="image-upload" id="imageUpload">
                            <img src="/api/image/upload-icon.png" alt="Upload" class="upload-icon" onerror="this.textContent='📷';">
                            <div class="upload-text" data-key="upload_instruction">Click to upload or drag & drop</div>
                            <div class="upload-hint" data-key="png_only">PNG files only, max 5MB</div>
                        </div>
                        <div class="image-preview" id="imagePreview">
                            <img id="previewImg" src="" alt="Preview">
                            <button type="button" class="remove-image" id="removeImage">
                                <img src="/api/image/close-icon.png" alt="Remove" onerror="this.textContent='✕';">
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <span data-key="variants_pricing">Product Variants & Pricing (OMR)</span>
                            <span class="required">*</span>
                        </label>
                        <div class="variants-section">
                            <div class="variants-header">
                                <img src="/api/image/sizes-icon.png" alt="Sizes" class="variants-icon" onerror="this.textContent='💎';">
                                <strong data-key="available_sizes">Available Sizes</strong>
                            </div>
                            
                            <div class="variant-item-form">
                                <div class="variant-toggle">
                                    <input type="checkbox" id="variant_5ml" checked>
                                    <label for="variant_5ml" data-key="sample_5ml">5ml Sample</label>
                                </div>
                                <input type="number" id="price_5ml" class="price-input" 
                                       placeholder="2.500" step="0.001" min="0" value="2.500">
                            </div>
                            
                            <div class="variant-item-form">
                                <div class="variant-toggle">
                                    <input type="checkbox" id="variant_10ml" checked>
                                    <label for="variant_10ml" data-key="sample_10ml">10ml Sample</label>
                                </div>
                                <input type="number" id="price_10ml" class="price-input" 
                                       placeholder="4.500" step="0.001" min="0" value="4.500">
                            </div>
                            
                            <div class="variant-item-form">
                                <div class="variant-toggle">
                                    <input type="checkbox" id="variant_30ml" checked>
                                    <label for="variant_30ml" data-key="sample_30ml">30ml Sample</label>
                                </div>
                                <input type="number" id="price_30ml" class="price-input" 
                                       placeholder="12.000" step="0.001" min="0" value="12.000">
                            </div>
                            
                            <div class="variant-item-form whole-bottle">
                                <div class="variant-toggle">
                                    <input type="checkbox" id="variant_whole" checked>
                                    <label for="variant_whole" data-key="whole_bottle">
                                        <img src="/api/image/gift-icon.png" alt="Gift" class="variant-gift-icon" onerror="this.textContent='🎁';">
                                        Whole Bottle (Original)
                                    </label>
                                </div>
                                <div class="price-note" data-key="contact_pricing">Contact for pricing</div>
                            </div>
                        </div>
                        <small class="form-hint" data-key="variants_note">
                            At least one variant must be enabled. Prices in Omani Rial (OMR).
                        </small>
                    </div>

                    <button type="submit" class="submit-btn" id="submitBtn">
                        <img src="/api/image/save-icon.png" alt="Save" class="btn-icon" onerror="this.textContent='✨';">
                        <span class="btn-text" data-key="add_to_store">Add Fragrance to Store</span>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Notification Permission Modal -->
    <div class="modal-overlay" id="notificationModal">
        <div class="modal-content notification-modal">
            <div class="modal-header">
                <h2 class="modal-title" data-key="enable_notifications">Enable Notifications</h2>
                <button class="close-btn" onclick="closeNotificationModal()">
                    <img src="/api/image/close-icon.png" alt="Close" onerror="this.textContent='✕';">
                </button>
            </div>
            <div class="modal-body">
                <div class="notification-explanation">
                    <img src="/api/image/notification-large-icon.png" alt="Notifications" class="notification-large-icon" onerror="this.textContent='🔔';">
                    <h3 data-key="stay_informed">Stay Informed About New Orders</h3>
                    <p data-key="notification_benefits">Enable browser notifications to get instant alerts when customers place new orders. This helps you:</p>
                    <ul>
                        <li data-key="benefit_instant">Receive instant order notifications</li>
                        <li data-key="benefit_respond">Respond to customers quickly</li>
                        <li data-key="benefit_track">Keep track of your business activity</li>
                        <li data-key="benefit_miss">Never miss an important order</li>
                    </ul>
                </div>
                <div class="notification-actions">
                    <button class="btn btn-primary" onclick="enableNotifications()" data-key="enable_now">Enable Notifications</button>
                    <button class="btn btn-secondary" onclick="closeNotificationModal()" data-key="maybe_later">Maybe Later</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Your JavaScript code here
    </script>
</body>
</html>