<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qotor - Premium Fragrances</title>
    <style>
        :root {
    --primary-color: #1a237e;
    --primary-light: #3949ab;
    --secondary-color: #ffd700;
    --text-primary: #212121;
    --text-secondary: #757575;
    --background: #ffffff;
    --surface: #f5f5f5;
    --border: #e0e0e0;
    --success: #4caf50;
    --error: #f44336;
    --spacing-sm: 0.5rem;
    --spacing-md: 1rem;
    --spacing-lg: 1.5rem;
    --spacing-xl: 2rem;
    --radius-md: 8px;
    --radius-lg: 12px;
    --transition: 0.3s ease;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Arial', sans-serif;
    line-height: 1.6;
    color: var(--text-primary);
    background: var(--background);
    direction: ltr;
}

body.rtl {
    direction: rtl;
}

/* Header */
.header {
    background: var(--primary-color);
    color: white;
    padding: var(--spacing-md) 0;
    position: sticky;
    top: 0;
    z-index: 1000;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.nav-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 var(--spacing-lg);
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: var(--spacing-lg);
}

.logo-section {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.logo-image {
    height: 40px;
    width: auto;
}

.logo {
    font-size: 1.8rem;
    font-weight: bold;
    color: var(--secondary-color);
}

.nav-center {
    flex: 1;
    display: flex;
    justify-content: center;
}

.search-container {
    position: relative;
    max-width: 400px;
    width: 100%;
}

.search-input {
    width: 100%;
    padding: var(--spacing-sm) var(--spacing-md) var(--spacing-sm) 2.5rem;
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: var(--radius-lg);
    background: rgba(255, 255, 255, 0.1);
    color: white;
    font-size: 1rem;
    transition: var(--transition);
}

.search-input:focus {
    outline: none;
    border-color: var(--secondary-color);
    background: rgba(255, 255, 255, 0.15);
}

.search-input::placeholder {
    color: rgba(255, 255, 255, 0.7);
}

.search-icon {
    position: absolute;
    left: var(--spacing-sm);
    top: 50%;
    transform: translateY(-50%);
    width: 20px;
    height: 20px;
    filter: brightness(0) invert(1);
    opacity: 0.7;
}

.search-clear {
    position: absolute;
    right: var(--spacing-sm);
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    cursor: pointer;
    padding: var(--spacing-xs);
    border-radius: 50%;
    transition: var(--transition);
}

.search-clear:hover {
    background: rgba(255, 255, 255, 0.1);
}

.search-clear img {
    width: 16px;
    height: 16px;
    filter: brightness(0) invert(1);
}

.nav-actions {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
}

.language-switcher {
    position: relative;
}

.lang-btn {
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.2);
    color: white;
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--radius-md);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-size: 0.9rem;
    font-weight: 500;
    transition: var(--transition);
}

.lang-btn:hover {
    background: rgba(255, 255, 255, 0.2);
    border-color: var(--secondary-color);
}

.lang-btn img {
    width: 16px;
    height: 16px;
    filter: brightness(0) invert(1);
}

.cart-btn {
    background: var(--secondary-color);
    color: var(--text-primary);
    border: none;
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--radius-md);
    cursor: pointer;
    font-weight: bold;
    transition: var(--transition);
    position: relative;
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
}

.cart-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
}

.cart-btn img {
    width: 20px;
    height: 20px;
}

.cart-count {
    position: absolute;
    top: -8px;
    right: -8px;
    background: var(--error);
    color: white;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    font-size: 0.75rem;
    display: flex;
    align-items: center;
    justify-content: center;
}

.admin-btn {
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.2);
    color: white;
    padding: var(--spacing-sm);
    border-radius: var(--radius-md);
    text-decoration: none;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    transition: var(--transition);
}

.admin-btn:hover {
    background: rgba(255, 255, 255, 0.2);
    border-color: var(--secondary-color);
}

.admin-btn img {
    width: 20px;
    height: 20px;
    filter: brightness(0) invert(1);
}

/* Premium Banner */
.premium-banner {
    background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
    color: white;
    padding: var(--spacing-lg) 0;
    border-bottom: 3px solid var(--secondary-color);
}

.banner-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-xl);
}

.banner-content {
    flex: 1;
}

.banner-title {
    font-size: 2rem;
    margin-bottom: var(--spacing-sm);
    color: var(--secondary-color);
    font-weight: bold;
}

.banner-subtitle {
    font-size: 1.1rem;
    opacity: 0.9;
}

.banner-image {
    flex-shrink: 0;
}

.banner-image img {
    width: 120px;
    height: 120px;
    object-fit: cover;
    border-radius: var(--radius-lg);
    border: 2px solid var(--secondary-color);
}

/* Main Content */
.main-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: var(--spacing-xl);
}

.products-section {
    margin-top: var(--spacing-xl);
}

.section-title {
    font-size: 2rem;
    margin-bottom: var(--spacing-lg);
    text-align: center;
}

.loading, .error {
    text-align: center;
    padding: var(--spacing-xl);
    font-size: 1.1rem;
}

.products-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: var(--spacing-lg);
    margin-top: var(--spacing-lg);
}

.product-card {
    background: white;
    border-radius: var(--radius-lg);
    overflow: hidden;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transition: var(--transition);
    cursor: pointer;
}

.product-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.product-image {
    width: 100%;
    height: 200px;
    background: var(--surface);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 3rem;
    color: var(--text-secondary);
    border-radius: var(--radius-md) var(--radius-md) 0 0;
}

.product-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.product-info {
    padding: var(--spacing-lg);
}

.product-brand {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: var(--spacing-sm);
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
}

.brand-image {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    object-fit: cover;
}

.product-name {
    font-size: 1.1rem;
    font-weight: bold;
    margin-bottom: var(--spacing-sm);
}

.product-description {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: var(--spacing-md);
    display: -webkit-box;
    line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* Modal */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 2000;
}

.modal-overlay.show {
    display: flex;
}

.modal-content {
    background: white;
    border-radius: var(--radius-lg);
    max-width: 600px;
    width: 90%;
    max-height: 90vh;
    overflow-y: auto;
    position: relative;
}

.modal-header {
    position: relative;
    height: 300px;
    background: var(--surface);
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-lg) var(--radius-lg) 0 0;
}

.modal-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: var(--radius-lg) var(--radius-lg) 0 0;
}

.close-btn {
    position: absolute;
    top: var(--spacing-md);
    right: var(--spacing-md);
    background: rgba(0, 0, 0, 0.5);
    color: white;
    border: none;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

.close-btn img {
    width: 16px;
    height: 16px;
    filter: brightness(0) invert(1);
}

.modal-body {
    padding: var(--spacing-xl);
}

.modal-brand {
    color: var(--text-secondary);
    margin-bottom: var(--spacing-sm);
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
}

.modal-title {
    font-size: 1.5rem;
    margin-bottom: var(--spacing-md);
}

.modal-description {
    color: var(--text-secondary);
    margin-bottom: var(--spacing-lg);
}

.variants-title {
    font-size: 1.2rem;
    margin-bottom: var(--spacing-md);
}

.variants-container {
    display: grid;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-lg);
}

.variant-option {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-md);
    border: 2px solid var(--border);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: var(--transition);
}

.variant-option:hover {
    border-color: var(--primary-light);
}

.variant-option.selected {
    border-color: var(--primary-color);
    background: rgba(26, 35, 126, 0.05);
}

.variant-size {
    font-weight: bold;
}

.variant-price {
    color: var(--primary-color);
    font-weight: bold;
}

.add-to-cart-btn {
    width: 100%;
    background: var(--primary-color);
    color: white;
    border: none;
    padding: var(--spacing-md);
    border-radius: var(--radius-md);
    font-size: 1.1rem;
    font-weight: bold;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
}

.add-to-cart-btn:disabled {
    background: var(--text-secondary);
    cursor: not-allowed;
}

.add-to-cart-btn:not(:disabled):hover {
    background: var(--primary-light);
}

.add-to-cart-btn img {
    width: 20px;
    height: 20px;
    filter: brightness(0) invert(1);
}

/* Cart Sidebar */
.cart-panel {
    position: fixed;
    top: 0;
    right: -400px;
    width: 400px;
    height: 100vh;
    background: white;
    box-shadow: -4px 0 15px rgba(0, 0, 0, 0.1);
    transition: right var(--transition);
    z-index: 2000;
    display: flex;
    flex-direction: column;
}

.cart-panel.open {
    right: 0;
}

.cart-header {
    padding: var(--spacing-lg);
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.cart-body {
    flex: 1;
    overflow-y: auto;
    padding: var(--spacing-lg);
}

.cart-item {
    display: flex;
    gap: var(--spacing-md);
    padding: var(--spacing-md) 0;
    border-bottom: 1px solid var(--border);
}

.cart-item:last-child {
    border-bottom: none;
}

.cart-item-image {
    width: 60px;
    height: 60px;
    background: var(--surface);
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
}

.cart-item-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.cart-item-details {
    flex: 1;
}

.cart-item-name {
    font-weight: bold;
    margin-bottom: var(--spacing-sm);
}

.cart-item-variant {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.cart-item-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: var(--spacing-sm);
}

.quantity-controls {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.qty-btn {
    background: var(--surface);
    border: none;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
}

.qty-btn:hover {
    background: var(--border);
}

.qty-btn img {
    width: 16px;
    height: 16px;
}

.cart-summary {
    padding: var(--spacing-lg);
    border-top: 1px solid var(--border);
}

.cart-total {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-lg);
    font-size: 1.2rem;
    font-weight: bold;
}

.checkout-btn {
    width: 100%;
    background: var(--success);
    color: white;
    border: none;
    padding: var(--spacing-md);
    border-radius: var(--radius-md);
    font-size: 1.1rem;
    font-weight: bold;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
}

.checkout-btn:hover {
    opacity: 0.9;
}

.checkout-btn img {
    width: 20px;
    height: 20px;
    filter: brightness(0) invert(1);
}

.empty-cart {
    text-align: center;
    padding: var(--spacing-xl);
    color: var(--text-secondary);
}

.empty-cart img {
    width: 60px;
    height: 60px;
    margin-bottom: var(--spacing-md);
    opacity: 0.5;
}

/* Footer */
.footer {
    background: var(--text-primary);
    color: white;
    padding: var(--spacing-xl) 0;
    margin-top: var(--spacing-xl);
}

.footer-content {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 var(--spacing-lg);
    text-align: center;
}

.footer-logo {
    font-size: 1.5rem;
    font-weight: bold;
    margin-bottom: var(--spacing-md);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
}

.footer-logo img {
    width: 30px;
    height: 30px;
}

.footer-contact {
    margin: var(--spacing-lg) 0;
}

.social-link {
    background: var(--primary-color);
    color: white;
    padding: var(--spacing-sm);
    border-radius: 50%;
    text-decoration: none;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
}

.social-link:hover {
    background: var(--primary-light);
}

.social-link img {
    width: 20px;
    height: 20px;
    filter: brightness(0) invert(1);
}

/* Floating WhatsApp Button */
.whatsapp-float {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #25d366;
    color: white;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3);
    z-index: 1000;
    transition: var(--transition);
}

.whatsapp-float:hover {
    transform: scale(1.1);
}

.whatsapp-float img {
    width: 30px;
    height: 30px;
    filter: brightness(0) invert(1);
}

/* Language Translations */
[data-key] {
    transition: opacity 0.2s ease;
}

/* RTL Support */
body.rtl .nav-container {
    direction: rtl;
}

body.rtl .search-icon {
    left: auto;
    right: var(--spacing-sm);
}

body.rtl .search-clear {
    right: auto;
    left: var(--spacing-sm);
}

body.rtl .search-input {
    padding: var(--spacing-sm) 2.5rem var(--spacing-sm) var(--spacing-md);
}

body.rtl .banner-container {
    flex-direction: row-reverse;
}

body.rtl .cart-count {
    right: auto;
    left: -8px;
}

body.rtl .product-brand,
body.rtl .modal-brand {
    flex-direction: row-reverse;
}

/* Responsive */
@media (max-width: 768px) {
    .nav-container {
        flex-wrap: wrap;
        gap: var(--spacing-md);
    }

    .nav-center {
        order: 3;
        flex-basis: 100%;
        margin-top: var(--spacing-sm);
    }

    .banner-container {
        flex-direction: column;
        text-align: center;
        gap: var(--spacing-lg);
    }

    .banner-title {
        font-size: 1.5rem;
    }

    .cart-panel {
        width: 100%;
        right: -100%;
    }

    .products-grid {
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    }

    .modal-content {
        width: 95%;
    }

    .main-container {
        padding: var(--spacing-md);
    }
}

@media (max-width: 480px) {
    .nav-actions {
        gap: var(--spacing-sm);
    }

    .search-input {
        font-size: 0.9rem;
    }

    .banner-title {
        font-size: 1.3rem;
    }

    .banner-subtitle {
        font-size: 1rem;
    }

    .products-grid {
        grid-template-columns: 1fr;
    }
}s {
    display: flex;
    justify-content: center;
    gap: var(--spacing-md);
    margin: var(--spacing-lg) 0;
}

.social-link
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav-container">
            <div class="logo-section">
                <img src="/api/image/logo.png" alt="Qotor" class="logo-image" onerror="this.style.display='none';">
                <div class="logo">Qotor</div>
            </div>
            
            <div class="nav-center">
                <!-- Search Bar -->
                <div class="search-container">
                    <img src="/api/image/search-icon.png" alt="Search" class="search-icon" onerror="this.textContent='🔍';">
                    <input type="text" id="searchInput" class="search-input" placeholder="Search fragrances..." data-key-placeholder="search_fragrances">
                    <button class="search-clear" id="searchClear" onclick="clearSearch()" style="display: none;">
                        <img src="/api/image/close-icon.png" alt="Clear" onerror="this.textContent='✕';">
                    </button>
                </div>
            </div>
            
            <div class="nav-actions">
                <!-- Language Switcher -->
                <div class="language-switcher">
                    <button class="lang-btn" onclick="toggleLanguage()" id="langBtn">
                        <img src="/api/image/language-icon.png" alt="Language" onerror="this.textContent='🌐';">
                        <span id="currentLang">EN</span>
                    </button>
                </div>
                
                <!-- Cart Button -->
                <button class="cart-btn" onclick="toggleCart()">
                    <img src="/api/image/cart-icon.png" alt="Cart" onerror="this.textContent='🛒';">
                    <span class="cart-text" data-key="cart">Cart</span>
                    <span class="cart-count" id="cartCount">0</span>
                </button>
                
                <!-- Admin Login Button -->
                <a href="/admin/login.html" class="admin-btn" title="Admin Login">
                    <img src="/api/image/admin-icon.png" alt="Admin" onerror="this.textContent='👤';">
                </a>
            </div>
        </nav>
    </header>

    <!-- Premium Banner -->
    <section class="premium-banner">
        <div class="banner-container">
            <div class="banner-content">
                <h2 class="banner-title" data-key="premium_fragrances">Premium Fragrances</h2>
                <p class="banner-subtitle" data-key="banner_subtitle">Discover luxury scents from around the world</p>
            </div>
            <div class="banner-image">
                <img src="/api/image/premium-banner.png" alt="Premium Fragrances" onerror="this.style.display='none';">
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Products Section -->
        <section class="products-section">
            <h2 class="section-title" data-key="our_collection">Our Collection</h2>
            
            <div id="loading" class="loading" data-key="loading_fragrances">Loading fragrances...</div>
            <div id="error" class="error" style="display: none;" data-key="error_loading">Error loading fragrances</div>
            <div id="products-grid" class="products-grid" style="display: none;"></div>
            <div id="empty-state" class="empty-cart" style="display: none;">
                <img src="/api/image/empty-icon.png" alt="Empty" onerror="this.style.display='none';">
                <h3 data-key="no_fragrances">No fragrances available</h3>
                <p data-key="check_back_soon">Check back soon for our amazing collection!</p>
            </div>
            <div id="no-results" class="empty-cart" style="display: none;">
                <img src="/api/image/search-empty-icon.png" alt="No Results" onerror="this.style.display='none';">
                <h3 data-key="no_search_results">No search results</h3>
                <p data-key="try_different_search">Try a different search term</p>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">
                <img src="/api/image/logo-white.png" alt="Qotor" onerror="this.style.display='none';">
                <span>Qotor</span>
            </div>
            <p data-key="footer_tagline">Premium fragrances for discerning tastes</p>
            
            <div class="social-links">
                <a href="https://instagram.com/qotor" class="social-link" target="_blank">
                    <img src="/api/image/instagram-icon.png" alt="Instagram" onerror="this.textContent='📷';">
                </a>
                <a href="https://snapchat.com/add/qotor" class="social-link" target="_blank">
                    <img src="/api/image/snapchat-icon.png" alt="Snapchat" onerror="this.textContent='👻';">
                </a>
                <a href="https://wa.me/96812345678" class="social-link" target="_blank">
                    <img src="/api/image/whatsapp-icon.png" alt="WhatsApp" onerror="this.textContent='💬';">
                </a>
            </div>
            
            <div class="footer-contact">
                <p data-key="footer_contact">Contact: info@qotor.com</p>
                <p data-key="footer_copyright">&copy; 2024 Qotor. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Floating WhatsApp -->
    <a href="https://wa.me/96812345678" class="whatsapp-float" target="_blank">
        <img src="/api/image/whatsapp-icon.png" alt="WhatsApp" onerror="this.textContent='💬';">
    </a>

    <!-- Product Modal -->
    <div class="modal-overlay" id="productModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-image" id="modalImage">
                    <img src="/api/image/placeholder-fragrance.png" alt="Fragrance" onerror="this.style.display='none';">
                </div>
                <button class="close-btn" onclick="closeProductModal()">
                    <img src="/api/image/close-icon.png" alt="Close" onerror="this.textContent='✕';">
                </button>
            </div>
            <div class="modal-body">
                <div class="modal-brand" id="modalBrand">
                    <img src="/api/image/brand-placeholder.png" alt="Brand" class="brand-image" onerror="this.style.display='none';">
                    <span></span>
                </div>
                <h2 class="modal-title" id="modalTitle"></h2>
                <p class="modal-description" id="modalDescription"></p>
                
                <div class="variants-selection">
                    <h3 class="variants-title" data-key="choose_size">Choose Your Size</h3>
                    <div id="variantsContainer" class="variants-container"></div>
                </div>
                
                <button id="addToCartBtn" class="add-to-cart-btn" disabled onclick="addToCart()">
                    <img src="/api/image/cart-add-icon.png" alt="Add" onerror="this.style.display='none';">
                    <span data-key="add_to_cart">Add to Cart</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Cart Panel -->
    <div class="cart-panel" id="cartPanel">
        <div class="cart-header">
            <h2 data-key="your_cart">Your Cart</h2>
            <button class="close-btn" onclick="toggleCart()">
                <img src="/api/image/close-icon.png" alt="Close" onerror="this.textContent='✕';">
            </button>
        </div>
        <div class="cart-body">
            <div id="cartItems"></div>
            <div id="emptyCart" class="empty-cart">
                <img src="/api/image/empty-cart-icon.png" alt="Empty Cart" onerror="this.style.display='none';">
                <h3 data-key="empty_cart_title">Your cart is empty</h3>
                <p data-key="empty_cart_message">Add some beautiful fragrances!</p>
            </div>
        </div>
        <div class="cart-summary" id="cartSummary" style="display: none;">
            <div class="cart-total">
                <span data-key="total">Total: <span id="cartTotalPrice">0.000 OMR</span></span>
            </div>
            <button class="checkout-btn" onclick="proceedToCheckout()">
                <img src="/api/image/checkout-icon.png" alt="Checkout" onerror="this.style.display='none';">
                <span data-key="proceed_to_checkout">Proceed to Checkout</span>
            </button>
        </div>
    </div>

    <script>
        // Global variables
let allFragrances = [];
let filteredFragrances = [];
let cart = [];
let currentFragrance = null;
let selectedVariant = null;
let currentLanguage = 'en';

// Language translations
const translations = {
    en: {
        search_fragrances: 'Search fragrances...',
        cart: 'Cart',
        premium_fragrances: 'Premium Fragrances',
        banner_subtitle: 'Discover luxury scents from around the world',
        our_collection: 'Our Collection',
        loading_fragrances: 'Loading fragrances...',
        error_loading: 'Error loading fragrances',
        no_fragrances: 'No fragrances available',
        check_back_soon: 'Check back soon for our amazing collection!',
        no_search_results: 'No search results',
        try_different_search: 'Try a different search term',
        choose_size: 'Choose Your Size',
        add_to_cart: 'Add to Cart',
        your_cart: 'Your Cart',
        empty_cart_title: 'Your cart is empty',
        empty_cart_message: 'Add some beautiful fragrances!',
        total: 'Total:',
        proceed_to_checkout: 'Proceed to Checkout',
        footer_tagline: 'Premium fragrances for discerning tastes',
        footer_contact: 'Contact: info@qotor.com',
        footer_copyright: '© 2024 Qotor. All rights reserved.',
        added_to_cart: 'Added to cart!',
        remove: 'Remove'
    },
    ar: {
        search_fragrances: 'البحث عن العطور...',
        cart: 'السلة',
        premium_fragrances: 'العطور الفاخرة',
        banner_subtitle: 'اكتشف العطور الفاخرة من جميع أنحاء العالم',
        our_collection: 'مجموعتنا',
        loading_fragrances: 'جاري تحميل العطور...',
        error_loading: 'خطأ في تحميل العطور',
        no_fragrances: 'لا توجد عطور متاحة',
        check_back_soon: 'تحقق مرة أخرى قريباً للحصول على مجموعتنا المذهلة!',
        no_search_results: 'لا توجد نتائج بحث',
        try_different_search: 'جرب مصطلح بحث مختلف',
        choose_size: 'اختر الحجم',
        add_to_cart: 'أضف إلى السلة',
        your_cart: 'سلتك',
        empty_cart_title: 'سلتك فارغة',
        empty_cart_message: 'أضف بعض العطور الجميلة!',
        total: 'المجموع:',
        proceed_to_checkout: 'المتابعة للدفع',
        footer_tagline: 'العطور الفاخرة لأصحاب الذوق الرفيع',
        footer_contact: 'التواصل: info@qotor.com',
        footer_copyright: '© 2024 قطر. جميع الحقوق محفوظة.',
        added_to_cart: 'تم الإضافة للسلة!',
        remove: 'إزالة'
    }
};

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
    loadCart();
    loadFragrances();
    updateCartDisplay();
    setupSearch();
    updateLanguage();
    
    // Load saved language preference
    const savedLang = localStorage.getItem('qotor_language');
    if (savedLang && savedLang !== currentLanguage) {
        currentLanguage = savedLang;
        toggleLanguage();
    }
});

// Setup search functionality
function setupSearch() {
    const searchInput = document.getElementById('searchInput');
    const searchClear = document.getElementById('searchClear');
    
    searchInput.addEventListener('input', function() {
        const searchTerm = this.value.trim();
        if (searchTerm) {
            searchClear.style.display = 'block';
            debouncedSearch(searchTerm);
        } else {
            searchClear.style.display = 'none';
            displayFragrances(allFragrances);
            document.getElementById('no-results').style.display = 'none';
        }
    });
    
    // Enter key handling
    searchInput.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
            e.preventDefault();
            this.blur();
        }
    });
}

// Performance optimization: debounce search
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// Apply debounced search
const debouncedSearch = debounce(searchFragrances, 300);

// Search fragrances
function searchFragrances(searchTerm) {
    const term = searchTerm.toLowerCase();
    filteredFragrances = allFragrances.filter(fragrance => {
        return fragrance.name.toLowerCase().includes(term) ||
               (fragrance.brand && fragrance.brand.toLowerCase().includes(term)) ||
               fragrance.description.toLowerCase().includes(term);
    });
    
    displayFragrances(filteredFragrances);
    
    // Show/hide no results message
    const noResults = document.getElementById('no-results');
    const productsGrid = document.getElementById('products-grid');
    
    if (filteredFragrances.length === 0) {
        productsGrid.style.display = 'none';
        noResults.style.display = 'block';
    } else {
        noResults.style.display = 'none';
    }
}

// Clear search
function clearSearch() {
    const searchInput = document.getElementById('searchInput');
    const searchClear = document.getElementById('searchClear');
    
    searchInput.value = '';
    searchClear.style.display = 'none';
    displayFragrances(allFragrances);
    
    // Hide no results message
    document.getElementById('no-results').style.display = 'none';
}

// Language switching
function toggleLanguage() {
    currentLanguage = currentLanguage === 'en' ? 'ar' : 'en';
    localStorage.setItem('qotor_language', currentLanguage);
    
    // Update language button
    document.getElementById('currentLang').textContent = currentLanguage.toUpperCase();
    
    // Update body direction
    document.body.className = currentLanguage === 'ar' ? 'rtl' : '';
    
    // Update all translated elements
    updateLanguage();
}

// Update language for all elements
function updateLanguage() {
    const elements = document.querySelectorAll('[data-key]');
    elements.forEach(element => {
        const key = element.getAttribute('data-key');
        if (translations[currentLanguage] && translations[currentLanguage][key]) {
            element.textContent = translations[currentLanguage][key];
        }
    });
    
    // Update placeholders
    const placeholderElements = document.querySelectorAll('[data-key-placeholder]');
    placeholderElements.forEach(element => {
        const key = element.getAttribute('data-key-placeholder');
        if (translations[currentLanguage] && translations[currentLanguage][key]) {
            element.placeholder = translations[currentLanguage][key];
        }
    });
}

// Load fragrances from API
async function loadFragrances() {
    const loading = document.getElementById('loading');
    const error = document.getElementById('error');
    const productsGrid = document.getElementById('products-grid');
    const emptyState = document.getElementById('empty-state');

    showOnly('loading');

    try {
        const response = await fetch('/api/fragrances');
        
        if (response.ok) {
            const result = await response.json();
            
            if (result.success && result.data) {
                allFragrances = result.data;
                filteredFragrances = [...allFragrances];
                
                if (allFragrances.length > 0) {
                    displayFragrances(allFragrances);
                    showOnly('products-grid');
                } else {
                    showOnly('empty-state');
                }
            } else {
                throw new Error(result.error || 'Failed to load fragrances');
            }
        } else {
            throw new Error('Failed to fetch fragrances');
        }
    } catch (err) {
        console.error('Error loading fragrances:', err);
        showOnly('error');
    }
}

// Display fragrances in grid
function displayFragrances(fragrances) {
    const grid = document.getElementById('products-grid');
    
    if (fragrances.length === 0) {
        grid.innerHTML = '';
        return;
    }
    
    grid.innerHTML = fragrances.map(fragrance => `
        <div class="product-card" onclick="openProductModal(${fragrance.id})">
            <div class="product-image">
                ${fragrance.image ? 
                    `<img src="${fragrance.image}" alt="${fragrance.name}" onerror="this.src='/api/image/placeholder-fragrance.png'">` : 
                    `<img src="/api/image/placeholder-fragrance.png" alt="${fragrance.name}">`
                }
            </div>
            <div class="product-info">
                ${fragrance.brand ? `
                    <div class="product-brand">
                        <img src="/api/image/brand-${fragrance.brand.toLowerCase().replace(/\s+/g, '-')}.png" 
                             alt="${fragrance.brand}" class="brand-image" 
                             onerror="this.src='/api/image/brand-placeholder.png'">
                        <span>${fragrance.brand}</span>
                    </div>
                ` : ''}
                <div class="product-name">${fragrance.name}</div>
                <div class="product-description">${fragrance.description}</div>
            </div>
        </div>
    `).join('');
    
    grid.style.display = 'grid';
}

// Show only specific element
function showOnly(elementId) {
    const elements = ['loading', 'error', 'products-grid', 'empty-state', 'no-results'];
    elements.forEach(id => {
        const element = document.getElementById(id);
        if (element) {
            element.style.display = id === elementId ? (id === 'products-grid' ? 'grid' : 'block') : 'none';
        }
    });
}

// Open product modal
function openProductModal(fragranceId) {
    const fragrance = allFragrances.find(f => f.id === fragranceId);
    if (!fragrance) return;

    currentFragrance = fragrance;
    selectedVariant = null;

    // Update modal content
    const modalBrand = document.getElementById('modalBrand');
    if (fragrance.brand) {
        modalBrand.querySelector('img').src = `/api/image/brand-${fragrance.brand.toLowerCase().replace(/\s+/g, '-')}.png`;
        modalBrand.querySelector('span').textContent = fragrance.brand;
        modalBrand.style.display = 'flex';
    } else {
        modalBrand.style.display = 'none';
    }
    
    document.getElementById('modalTitle').textContent = fragrance.name;
    document.getElementById('modalDescription').textContent = fragrance.description;
    
    // Update modal image
    const modalImage = document.getElementById('modalImage');
    const modalImg = modalImage.querySelector('img');
    if (fragrance.image) {
        modalImg.src = fragrance.image;
        modalImg.style.display = 'block';
    } else {
        modalImg.src = '/api/image/placeholder-fragrance.png';
        modalImg.style.display = 'block';
    }

    // Display variants
    displayVariants(fragrance.variants || []);

    // Show modal
    document.getElementById('productModal').classList.add('show');
    document.body.style.overflow = 'hidden';
}

// Close product modal
function closeProductModal() {
    document.getElementById('productModal').classList.remove('show');
    document.body.style.overflow = 'auto';
    currentFragrance = null;
    selectedVariant = null;
}

// Display product variants
function displayVariants(variants) {
    const container = document.getElementById('variantsContainer');
    const addToCartBtn = document.getElementById('addToCartBtn');
    
    if (!variants || variants.length === 0) {
        container.innerHTML = '<p>No variants available</p>';
        addToCartBtn.disabled = true;
        return;
    }

    container.innerHTML = variants.map(variant => `
        <div class="variant-option" onclick="selectVariant(${variant.id})" data-variant-id="${variant.id}">
            <div class="variant-size">
                ${variant.is_whole_bottle ? 'Whole Bottle' : `${variant.size_ml}ml`}
            </div>
            <div class="variant-price">${(variant.price_cents / 1000).toFixed(3)} OMR</div>
        </div>
    `).join('');

    addToCartBtn.disabled = true;
}

// Select variant
function selectVariant(variantId) {
    // Remove previous selection
    document.querySelectorAll('.variant-option').forEach(el => {
        el.classList.remove('selected');
    });

    // Add selection to clicked variant
    const variantEl = document.querySelector(`[data-variant-id="${variantId}"]`);
    if (variantEl) {
        variantEl.classList.add('selected');
    }

    // Find and store selected variant
    selectedVariant = currentFragrance.variants.find(v => v.id === variantId);
    
    // Enable add to cart button
    document.getElementById('addToCartBtn').disabled = !selectedVariant;
}

// Add to cart
function addToCart() {
    if (!currentFragrance || !selectedVariant) return;

    const existingItem = cart.find(item => 
        item.fragranceId === currentFragrance.id && 
        item.variantId === selectedVariant.id
    );

    if (existingItem) {
        existingItem.quantity += 1;
    } else {
        cart.push({
            fragranceId: currentFragrance.id,
            variantId: selectedVariant.id,
            fragranceName: currentFragrance.name,
            fragranceBrand: currentFragrance.brand,
            fragranceImage: currentFragrance.image,
            variantSize: selectedVariant.is_whole_bottle ? 'Whole Bottle' : `${selectedVariant.size_ml}ml`,
            variantPrice: selectedVariant.price_cents / 1000,
            quantity: 1
        });
    }

    saveCart();
    updateCartDisplay();
    closeProductModal();
    
    // Show success message
    showToast(translations[currentLanguage]['added_to_cart']);
}

// Cart functions
function loadCart() {
    const saved = localStorage.getItem('qotor_cart');
    if (saved) {
        cart = JSON.parse(saved);
    }
}

function saveCart() {
    localStorage.setItem('qotor_cart', JSON.stringify(cart));
}

function updateCartDisplay() {
    const cartCount = document.getElementById('cartCount');
    const cartItems = document.getElementById('cartItems');
    const emptyCart = document.getElementById('emptyCart');
    const cartSummary = document.getElementById('cartSummary');
    
    const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
    cartCount.textContent = totalItems;
    cartCount.style.display = totalItems > 0 ? 'flex' : 'none';

    if (cart.length === 0) {
        cartItems.style.display = 'none';
        emptyCart.style.display = 'block';
        cartSummary.style.display = 'none';
    } else {
        cartItems.style.display = 'block';
        emptyCart.style.display = 'none';
        cartSummary.style.display = 'block';
        renderCartItems();
        updateCartTotal();
    }
}

function renderCartItems() {
    const container = document.getElementById('cartItems');
    
    container.innerHTML = cart.map((item, index) => `
        <div class="cart-item">
            <div class="cart-item-image">
                ${item.fragranceImage ? 
                    `<img src="${item.fragranceImage}" alt="${item.fragranceName}" onerror="this.src='/api/image/placeholder-fragrance.png'">` : 
                    `<img src="/api/image/placeholder-fragrance.png" alt="${item.fragranceName}">`
                }
            </div>
            <div class="cart-item-details">
                <div class="cart-item-name">
                    ${item.fragranceBrand ? `${item.fragranceBrand} ` : ''}${item.fragranceName}
                </div>
                <div class="cart-item-variant">${item.variantSize}</div>
                <div class="cart-item-controls">
                    <div class="quantity-controls">
                        <button class="qty-btn" onclick="updateQuantity(${index}, -1)">
                            <img src="/api/image/minus-icon.png" alt="-" onerror="this.textContent='-';">
                        </button>
                        <span>${item.quantity}</span>
                        <button class="qty-btn" onclick="updateQuantity(${index}, 1)">
                            <img src="/api/image/plus-icon.png" alt="+" onerror="this.textContent='+';">
                        </button>
                    </div>
                    <div class="cart-item-price">${(item.variantPrice * item.quantity).toFixed(3)} OMR</div>
                </div>
                <button onclick="removeFromCart(${index})" style="background:none;border:none;color:var(--error);cursor:pointer;margin-top:8px;font-size:0.9rem;">
                    ${translations[currentLanguage]['remove'] || 'Remove'}
                </button>
            </div>
        </div>
    `).join('');
}

function updateQuantity(itemIndex, change) {
    if (cart[itemIndex]) {
        cart[itemIndex].quantity += change;
        if (cart[itemIndex].quantity <= 0) {
            cart.splice(itemIndex, 1);
        }
        saveCart();
        updateCartDisplay();
    }
}

function removeFromCart(itemIndex) {
    if (cart[itemIndex]) {
        cart.splice(itemIndex, 1);
        saveCart();
        updateCartDisplay();
    }
}

function updateCartTotal() {
    const total = cart.reduce((sum, item) => sum + (item.variantPrice * item.quantity), 0);
    document.getElementById('cartTotalPrice').textContent = `${total.toFixed(3)} OMR`;
}

function toggleCart() {
    const cartPanel = document.getElementById('cartPanel');
    cartPanel.classList.toggle('open');
}

function proceedToCheckout() {
    if (cart.length === 0) return;
    
    // Store cart data for checkout page
    sessionStorage.setItem('checkout_cart', JSON.stringify(cart));
    
    // Redirect to checkout page
    window.location.href = '/checkout.html';
}

// Utility functions
function showToast(message) {
    // Create toast element
    const toast = document.createElement('div');
    toast.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: var(--success);
        color: white;
        padding: 12px 24px;
        border-radius: 8px;
        z-index: 3000;
        font-weight: bold;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        transform: translateX(100%);
        transition: transform 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
    `;
    
    // Add icon
    const icon = document.createElement('img');
    icon.src = '/api/image/success-icon.png';
    icon.alt = 'Success';
    icon.style.cssText = 'width: 16px; height: 16px; filter: brightness(0) invert(1);';
    icon.onerror = function() { this.textContent = '✓'; this.style.filter = 'none'; };
    
    const text = document.createElement('span');
    text.textContent = message;
    
    toast.appendChild(icon);
    toast.appendChild(text);
    
    document.body.appendChild(toast);
    
    // Animate in
    setTimeout(() => {
        toast.style.transform = 'translateX(0)';
    }, 100);
    
    // Remove after 3 seconds
    setTimeout(() => {
        toast.style.transform = 'translateX(100%)';
        setTimeout(() => {
            if (document.body.contains(toast)) {
                document.body.removeChild(toast);
            }
        }, 300);
    }, 3000);
}

// Close modal when clicking outside
document.getElementById('productModal').addEventListener('click', function(e) {
    if (e.target === this) {
        closeProductModal();
    }
});

// Close cart when clicking outside
document.addEventListener('click', function(e) {
    const cartPanel = document.getElementById('cartPanel');
    const cartBtn = document.querySelector('.cart-btn');
    
    if (cartPanel.classList.contains('open') && 
        !cartPanel.contains(e.target) && 
        !cartBtn.contains(e.target)) {
        toggleCart();
    }
});

// Keyboard shortcuts
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeProductModal();
        if (document.getElementById('cartPanel').classList.contains('open')) {
            toggleCart();
        }
    }
    
    // Language toggle with Ctrl/Cmd + L
    if ((e.ctrlKey || e.metaKey) && e.key === 'l') {
        e.preventDefault();
        toggleLanguage();
    }
    
    // Search focus with Ctrl/Cmd + K
    if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
        e.preventDefault();
        document.getElementById('searchInput').focus();
    }
});

// Handle online/offline status
window.addEventListener('online', function() {
    showToast('Connection restored');
});

window.addEventListener('offline', function() {
    showToast('Connection lost');
});

// Lazy loading for images
function setupLazyLoading() {
    if ('IntersectionObserver' in window) {
        const imageObserver = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    img.src = img.dataset.src;
                    img.classList.remove('lazy');
                    observer.unobserve(img);
                }
            });
        });

        document.querySelectorAll('img[data-src]').forEach(img => {
            imageObserver.observe(img);
        });
    }
}

// Initialize lazy loading after DOM content loaded
document.addEventListener('DOMContentLoaded', setupLazyLoading);
    </script>
</body>
</html>